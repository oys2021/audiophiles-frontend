<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audiophile Checkout</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #d87d4a;
            --primary-light: #fbaf85;
            --dark: #101010;
            --dark-light: #191919;
            --gray: #f1f1f1;
            --light: #fafafa;
            --white: #ffffff;
            --black: #000000;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Manrope', sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        .header {
            background-color: var(--dark);
            padding: 20px 0;
            position: relative;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 2px;
        }
        
        .logo a {
            color: var(--white);
            text-decoration: none;
        }
        
        .logo span {
            color: var(--primary);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        nav a {
            color: var(--white);
            text-decoration: none;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 2px;
            transition: color 0.3s;
        }
        
        nav a:hover {
            color: var(--primary);
        }
        
        .cart-btn {
            background: none;
            border: none;
            cursor: pointer;
            position: relative;
        }
        
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--primary);
            color: var(--white);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* Back Button */
        .back-section {
            padding: 30px 0;
            background-color: var(--light);
        }
        
        .back-btn {
            background: none;
            border: none;
            color: rgba(0,0,0,0.5);
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .back-btn:hover {
            color: var(--primary);
        }
        
        /* Checkout Content */
        .checkout-page {
            padding: 30px 0 100px;
        }
        
        .checkout-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }
        
        .form-section {
            background: var(--white);
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .form-section h2 {
            color: var(--primary);
            font-size: 18px;
            margin-bottom: 20px;
            letter-spacing: 1px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group.full-width {
            grid-column: span 2;
        }
        
        label {
            display: block;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #cfcfcf;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .radio-label {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid #cfcfcf;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .radio-label input {
            margin-right: 15px;
        }
        
        .radio-custom {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 1px solid #cfcfcf;
            border-radius: 50%;
            margin-right: 15px;
            position: relative;
        }
        
        .radio-custom::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background: var(--white);
            border-radius: 50%;
            display: none;
        }
        
        .radio-label input:checked + .radio-custom {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        .radio-label input:checked + .radio-custom::after {
            display: block;
        }
        
        .payment-fields {
            grid-column: span 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .cash-message {
            grid-column: span 2;
            padding: 20px;
            background: var(--gray);
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .cash-message p {
            color: rgba(0,0,0,0.5);
            line-height: 1.8;
        }
        
        .error-message {
            color: #cd2c2c;
            font-size: 12px;
            display: block;
            margin-top: 5px;
        }
        
        /* Order Summary */
        .order-summary {
            background: var(--white);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            align-self: flex-start;
        }
        
        .order-summary h2 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .summary-items {
            margin-bottom: 30px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .item-info {
            display: flex;
            align-items: center;
        }
        
        .item-image {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            background: var(--gray);
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .item-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }
        
        .item-details h3 {
            font-size: 14px;
            font-weight: 700;
        }
        
        .item-details p {
            font-size: 14px;
            color: rgba(0,0,0,0.5);
            font-weight: 700;
        }
        
        .item-quantity {
            font-weight: 700;
            color: rgba(0,0,0,0.5);
        }
        
        .summary-totals {
            margin-bottom: 30px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .total-row span:first-child {
            color: rgba(0,0,0,0.5);
            font-size: 15px;
        }
        
        .total-row.grand-total {
            margin-top: 20px;
        }
        
        .total-row.grand-total span:last-child {
            color: var(--primary);
            font-size: 18px;
            font-weight: 700;
        }
        
        .btn {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 15px 30px;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            transition: background 0.3s;
            text-transform: uppercase;
        }
        
        .btn:hover {
            background: var(--primary-light);
        }
        
        .btn-full {
            width: 100%;
        }
        
        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        /* Confirmation Modal */
        .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .confirmation-content {
            background: var(--white);
            border-radius: 8px;
            max-width: 540px;
            padding: 40px;
            position: relative;
            animation: modalAppear 0.4s ease-out;
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .confirmation-icon {
            width: 64px;
            height: 64px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .confirmation-icon i {
            font-size: 30px;
            color: var(--white);
        }
        
        .confirmation-content h2 {
            font-size: 28px;
            margin-bottom: 20px;
            letter-spacing: 1px;
        }
        
        .confirmation-content p {
            color: rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }
        
        .confirmation-summary {
            display: flex;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .confirmation-items {
            flex: 2;
            background: var(--gray);
            padding: 20px;
        }
        
        .confirmation-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .confirmation-total {
            flex: 1;
            background: var(--dark);
            color: var(--white);
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .confirmation-total span:first-child {
            color: rgba(255,255,255,0.5);
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .confirmation-total span:last-child {
            font-size: 18px;
            font-weight: 700;
        }
        
        /* Footer */
        .footer {
            background: var(--dark);
            color: var(--white);
            padding: 60px 0 40px;
        }
        
        .footer-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 40px;
        }
        
        .footer-nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        .footer-nav a {
            color: var(--white);
            text-decoration: none;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 2px;
            transition: color 0.3s;
        }
        
        .footer-nav a:hover {
            color: var(--primary);
        }
        
        .footer-bottom {
            display: flex;
            justify-content: space-between;
        }
        
        .footer-text {
            max-width: 540px;
            color: rgba(255,255,255,0.5);
            line-height: 1.8;
        }
        
        .footer-social {
            display: flex;
            gap: 15px;
            align-self: flex-end;
        }
        
        .footer-social a {
            color: var(--white);
            transition: color 0.3s;
        }
        
        .footer-social a:hover {
            color: var(--primary);
        }
        
        .footer-social svg {
            width: 24px;
            height: 24px;
        }
        
        .footer-copyright {
            margin-top: 40px;
            color: rgba(255,255,255,0.5);
            font-size: 14px;
        }
        
        /* Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* API Status */
        .api-status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }
        
        .api-status.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }
        
        .api-status.error {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .checkout-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-group.full-width {
                grid-column: span 1;
            }
            
            .payment-fields {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">audiophile</a>
                </div>
                
                <nav class="nav">
                    <ul>
                        <li><a href="index.html">HOME</a></li>
                        <li><a href="headphones.html">HEADPHONES</a></li>
                        <li><a href="speakers.html">SPEAKERS</a></li>
                        <li><a href="earphones.html">EARPHONES</a></li>
                    </ul>
                </nav>
                
                <a href="cart.html" class="cart-link">
                    <button class="cart-btn" id="cartBtn">
                        <svg width="23" height="20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8.625 15.833c1.132 0 2.054.935 2.054 2.084 0 1.148-.922 2.083-2.054 2.083-1.132 0-2.054-.935-2.054-2.083 0-1.15.922-2.084 2.054-2.084zm9.857 0c1.132 0 2.054.935 2.054 2.084 0 1.148-.922 2.083-2.054 2.083-1.132 0-2.053-.935-2.053-2.083 0-1.15.92-2.084 2.053-2.084zm-9.857 1.39a.69.69 0 00-.685.694.69.69 0 00.685.694.69.69 0 00.685-.694.69.69 0 00-.685-.694zm9.857 0a.69.69 0 00-.684.694.69.69 0 00.684.694.69.69 0 00.685-.694.69.69 0 00-.685-.694zM4.717 0c.316 0 .59.215.658.517l.481 2.122h16.47a.68.68 0 01.538.262c.127.166.168.38.11.579l-2.695 9.236a.672.672 0 01-.648.478H7.41a.667.667 0 00-.673.66c0 .364.303.66.674.66h12.219c.372 0 .674.295.674.66 0 .364-.302.66-.674.66H7.412c-1.115 0-2.021-.889-2.021-1.98 0-.812.502-1.511 1.218-1.816L4.176 1.32H.674A.667.667 0 010 .66C0 .296.302 0 .674 0zm16.716 3.958H6.156l1.797 7.917h11.17l2.31-7.917z" fill="#FFF" fill-rule="nonzero"/>
                        </svg>
                        <span class="cart-count" id="cart-count">0</span>
                    </button>
                </a>
            </div>
        </div>
    </header>

    <!-- Back Button -->
    <section class="back-section">
        <div class="container">
            <button class="back-btn" onclick="history.back()">Go Back</button>
        </div>
    </section>

    <!-- Checkout Content -->
    <section class="checkout-page">
        <div class="container">
            <div class="checkout-grid">
                <div class="checkout-form">
                    <h1>CHECKOUT</h1>
                    
                    <form id="checkoutForm">
                        <!-- Billing Details -->
                        <div class="form-section">
                            <h2>BILLING DETAILS</h2>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="name">Name</label>
                                    <input type="text" id="name" name="name" placeholder="Alexei Ward" required>
                                    <span class="error-message" id="nameError"></span>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email Address</label>
                                    <input type="email" id="email" name="email" placeholder="alexei@mail.com" required>
                                    <span class="error-message" id="emailError"></span>
                                </div>
                                <div class="form-group">
                                    <label for="phone">Phone Number</label>
                                    <input type="tel" id="phone" name="phone" placeholder="+1 202-555-0136" required>
                                    <span class="error-message" id="phoneError"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Shipping Info -->
                        <div class="form-section">
                            <h2>SHIPPING INFO</h2>
                            <div class="form-grid">
                                <div class="form-group full-width">
                                    <label for="address">Your Address</label>
                                    <input type="text" id="address" name="address" placeholder="1137 Williams Avenue" required>
                                    <span class="error-message" id="addressError"></span>
                                </div>
                                <div class="form-group">
                                    <label for="zip">ZIP Code</label>
                                    <input type="text" id="zip" name="zip" placeholder="10001" required>
                                    <span class="error-message" id="zipError"></span>
                                </div>
                                <div class="form-group">
                                    <label for="city">City</label>
                                    <input type="text" id="city" name="city" placeholder="New York" required>
                                    <span class="error-message" id="cityError"></span>
                                </div>
                                <div class="form-group">
                                    <label for="country">Country</label>
                                    <input type="text" id="country" name="country" placeholder="United States" required>
                                    <span class="error-message" id="countryError"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Details -->
                        <div class="form-section">
                            <h2>PAYMENT DETAILS</h2>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Payment Method</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="payment" value="emoney" checked>
                                            <span class="radio-custom"></span>
                                            e-Money
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="payment" value="cash">
                                            <span class="radio-custom"></span>
                                            Cash on Delivery
                                        </label>
                                    </div>
                                </div>
                                <div class="payment-fields" id="paymentFields">
                                    <div class="form-group">
                                        <label for="emoneyNumber">e-Money Number</label>
                                        <input type="text" id="emoneyNumber" name="emoneyNumber" placeholder="238521993">
                                        <span class="error-message" id="emoneyNumberError"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="emoneyPin">e-Money PIN</label>
                                        <input type="text" id="emoneyPin" name="emoneyPin" placeholder="6891">
                                        <span class="error-message" id="emoneyPinError"></span>
                                    </div>
                                </div>
                                <div class="cash-message" id="cashMessage" style="display: none;">
                                    <p>The 'Cash on Delivery' option enables you to pay in cash when our delivery courier arrives at your residence. Just make sure your address is correct so that your order will not be cancelled.</p>
                                </div>
                            </div>
                        </div>
                    </form>
                    
                    <div id="apiStatus" class="api-status"></div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <h2>SUMMARY</h2>
                    <div class="summary-items" id="summaryItems">
                        <!-- Cart items will be populated by JavaScript -->
                    </div>
                    <div class="summary-totals">
                        <div class="total-row">
                            <span>TOTAL</span>
                            <span id="summaryTotal">$ 0</span>
                        </div>
                        <div class="total-row">
                            <span>SHIPPING</span>
                            <span>$ 50</span>
                        </div>
                        <div class="total-row">
                            <span>VAT (INCLUDED)</span>
                            <span id="summaryVat">$ 0</span>
                        </div>
                        <div class="total-row grand-total">
                            <span>GRAND TOTAL</span>
                            <span id="grandTotal">$ 0</span>
                        </div>
                    </div>
                    <button id="submitOrder" class="btn btn-primary btn-full">
                        <span class="spinner" style="display: none;"></span>
                        CONTINUE & PAY
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Order Confirmation Modal -->
    <div class="confirmation-modal" id="confirmationModal">
        <div class="confirmation-content">
            <div class="confirmation-icon">
                <i class="fas fa-check"></i>
            </div>
            <h2>THANK YOU FOR YOUR ORDER</h2>
            <p>You will receive an email confirmation shortly.</p>
            <div class="confirmation-summary">
                <div class="confirmation-items" id="confirmationItems">
                    <!-- Items will be populated by JavaScript -->
                </div>
                <div class="confirmation-total">
                    <span>GRAND TOTAL</span>
                    <span id="confirmationGrandTotal">$ 0</span>
                </div>
            </div>
            <a href="index.html" class="btn btn-primary btn-full">BACK TO HOME</a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-top">
                <div class="footer-logo">
                    <a href="index.html">audiophile</a>
                </div>
                <nav class="footer-nav">
                    <ul>
                        <li><a href="index.html">HOME</a></li>
                        <li><a href="headphones.html">HEADPHONES</a></li>
                        <li><a href="speakers.html">SPEAKERS</a></li>
                        <li><a href="earphones.html">EARPHONES</a></li>
                    </ul>
                </nav>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-text">
                    <p>Audiophile is an all in one stop to fulfill your audio needs. We're a small team of music lovers and sound specialists who are devoted to helping you get the most out of personal audio. Come and visit our demo facility - we're open 7 days a week.</p>
                </div>
                <div class="footer-social">
                    <a href="#" aria-label="Facebook">
                        <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22.46 0H1.54C.69 0 0 .69 0 1.54v20.92C0 23.31.69 24 1.54 24h11.24v-9.3H9.69v-3.62h3.09V8.41c0-3.05 1.87-4.71 4.58-4.71 1.3 0 2.42.1 2.75.14v3.19l-1.89.001c-1.48 0-1.77.7-1.77 1.74v2.28h3.55l-.46 3.62h-3.09V24h6.06c.85 0 1.54-.69 1.54-1.54V1.54C24 .69 23.31 0 22.46 0z" fill="#FFF"/>
                        </svg>
                    </a>
                    <a href="#" aria-label="Twitter">
                        <svg width="24" height="20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M24 2.557a9.83 9.83 0 01-2.828.775A4.932 4.932 0 0023.337.608a9.864 9.864 0 01-3.127 1.195A4.916 4.916 0 0016.616.248c-3.179 0-5.515 2.966-4.797 6.045A13.978 13.978 0 011.671 1.149a4.93 4.93 0 001.523 6.574 4.903 4.903 0 01-2.229-.616c-.054 2.281 1.581 4.415 3.949 4.89a4.935 4.935 0 01-2.224.084 4.928 4.928 0 004.6 3.419A9.9 9.9 0 010 17.54a13.94 13.94 0 007.548 2.212c9.142 0 14.307-7.721 13.995-14.646A10.025 10.025 0 0024 2.557z" fill="#FFF"/>
                        </svg>
                    </a>
                    <a href="#" aria-label="Instagram">
                        <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" fill="#FFF"/>
                        </svg>
                    </a>
                </div>
            </div>
            
            <div class="footer-copyright">
                <p>Copyright 2021. All Rights Reserved</p>
            </div>
        </div>
    </footer>

    <script>
        // API endpoint
        const API_URL = 'https://audiophiles.up.railway.app/api/store/orders/';
        
    
        const cartCount = document.getElementById('cart-count');
        const summaryItems = document.getElementById('summaryItems');
        const confirmationItems = document.getElementById('confirmationItems');
        const submitBtn = document.getElementById('submitOrder');
        const spinner = document.querySelector('.spinner');
        const submitText = submitBtn.textContent;
        const apiStatus = document.getElementById('apiStatus');
        const confirmationModal = document.getElementById('confirmationModal');
        const paymentFields = document.getElementById('paymentFields');
        const cashMessage = document.getElementById('cashMessage');
        const paymentRadios = document.querySelectorAll('input[name="payment"]');
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            // Load cart from localStorage
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            
            // Update cart count
            updateCartCount(cart);
            
            // Render cart items
            renderCartItems(cart);
            
            // Calculate and display totals
            calculateTotals(cart);
            
            // Setup payment method toggle
            setupPaymentToggle();
            
            // Setup form submission
            setupFormSubmission(cart);
        });
        
        // Update cart count
        function updateCartCount(cart) {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
        }
        
        // Render cart items
        function renderCartItems(cart) {
            // Clear existing items
            summaryItems.innerHTML = '';
            
            if (cart.length === 0) {
                summaryItems.innerHTML = '<p>Your cart is empty</p>';
                return;
            }
            
            // Add items to order summary
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="item-info">
                        <div class="item-image">
                            <img src="${item.image || 'https://via.placeholder.com/64'}" alt="${item.name}">
                        </div>
                        <div class="item-details">
                            <h3>${item.name}</h3>
                            <p>$${item.price.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="item-quantity">x${item.quantity}</div>
                `;
                summaryItems.appendChild(cartItem);
            });
        }
        
        function calculateTotals(cart) {
            
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            const vat = subtotal * 0.2;
            
            const shipping = 50;
            
            const grandTotal = subtotal + shipping;
            
            document.getElementById('summaryTotal').textContent = `$ ${subtotal.toFixed(2)}`;
            document.getElementById('summaryVat').textContent = `$ ${vat.toFixed(2)}`;
            document.getElementById('grandTotal').textContent = `$ ${grandTotal.toFixed(2)}`;
            
            
            document.getElementById('confirmationGrandTotal').textContent = `$ ${grandTotal.toFixed(2)}`;
            
            return { subtotal, vat, shipping, grandTotal };
        }
        
        
        function setupPaymentToggle() {
            paymentRadios.forEach(radio => {
                radio.addEventListener('change', () => {
                    if (radio.value === 'emoney') {
                        paymentFields.style.display = 'grid';
                        cashMessage.style.display = 'none';
                    } else {
                        paymentFields.style.display = 'none';
                        cashMessage.style.display = 'block';
                    }
                });
            });
        }
        
        // Setup form submission
        function setupFormSubmission(cart) {
            submitBtn.addEventListener('click', async () => {
                // Validate form
                if (!validateForm()) {
                    return;
                }
                
                // Show loading state
                submitBtn.disabled = true;
                spinner.style.display = 'inline-block';
                submitBtn.textContent = 'Processing...';
                
                try {

                    const orderData = {
                        customer: {
                            name: document.getElementById('name').value,
                            email: document.getElementById('email').value,
                            phone: document.getElementById('phone').value,
                            address: document.getElementById('address').value,
                            city: document.getElementById('city').value,
                            zip: document.getElementById('zip').value,
                            country: document.getElementById('country').value
                        },
                        // payment: {
                        //     method: document.querySelector('input[name="payment"]:checked').value,
                        //     emoney_number: document.getElementById('emoneyNumber').value || null,
                        //     emoney_pin: document.getElementById('emoneyPin').value || null
                        // },
                        items: cart.map(item => ({
                            product: item.id,
                            quantity: item.quantity
                        })),
                        total: calculateTotals(cart).grandTotal
                    };
                    
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(orderData)
                    });
                    
                    // Check if response is successful
                    if (response.ok) {
                        const result = await response.json();
                        
                        // Show success message
                        apiStatus.textContent = 'Order successfully submitted to API!';
                        apiStatus.className = 'api-status success';
                        
                        // Update confirmation modal
                        updateConfirmationItems(cart);
                        
                        // Show confirmation modal
                        setTimeout(() => {
                            confirmationModal.style.display = 'flex';
                        }, 1000);
                        
                        // Clear cart
                        localStorage.removeItem('cart');
                    } else {
                        throw new Error('API request failed');
                    }
                } catch (error) {
                    // Show error message
                    apiStatus.textContent = 'Error: Could not submit order. Please try again later.';
                    apiStatus.className = 'api-status error';
                    console.error('API Error:', error);
                } finally {
                    // Reset button state
                    submitBtn.disabled = false;
                    spinner.style.display = 'none';
                    submitBtn.textContent = submitText;
                }
            });
        }
        
        // Update confirmation items
        function updateConfirmationItems(cart) {
            confirmationItems.innerHTML = '';
            
            if (cart.length === 0) return;
            
            // Add first item to confirmation
            const firstItem = cart[0];
            const confirmationItem = document.createElement('div');
            confirmationItem.className = 'confirmation-item';
            confirmationItem.innerHTML = `
                <div class="item-info">
                    <div class="item-image">
                        <img src="${firstItem.image || 'https://via.placeholder.com/64'}" alt="${firstItem.name}">
                    </div>
                    <div class="item-details">
                        <h3>${firstItem.name}</h3>
                        <p>$${firstItem.price.toFixed(2)}</p>
                    </div>
                </div>
                <div class="item-quantity">x${firstItem.quantity}</div>
            `;
            confirmationItems.appendChild(confirmationItem);
            
            // Add other items count if any
            if (cart.length > 1) {
                const otherItems = document.createElement('div');
                otherItems.className = 'confirmation-item';
                otherItems.innerHTML = `
                    <p>and ${cart.length - 1} other item(s)</p>
                `;
                confirmationItems.appendChild(otherItems);
            }
        }
        
        // Validate form
        function validateForm() {
            let isValid = true;
            const requiredFields = [
                'name', 'email', 'phone', 'address', 
                'zip', 'city', 'country'
            ];
            
            // Clear previous errors
            requiredFields.forEach(field => {
                document.getElementById(`${field}Error`).textContent = '';
            });
            
            // Check required fields
            requiredFields.forEach(field => {
                const input = document.getElementById(field);
                if (!input.value.trim()) {
                    document.getElementById(`${field}Error`).textContent = 'This field is required';
                    isValid = false;
                }
            });
            
            // Email validation
            const email = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email.value && !emailRegex.test(email.value)) {
                document.getElementById('emailError').textContent = 'Invalid email format';
                isValid = false;
            }
            
            // Phone validation
            const phone = document.getElementById('phone');
            const phoneRegex = /^[0-9+()\s-]{10,15}$/;
            if (phone.value && !phoneRegex.test(phone.value)) {
                document.getElementById('phoneError').textContent = 'Invalid phone number';
                isValid = false;
            }
            
            // Validate e-Money fields if selected
            if (document.querySelector('input[name="payment"]:checked').value === 'emoney') {
                const emoneyNumber = document.getElementById('emoneyNumber');
                if (!emoneyNumber.value.trim()) {
                    document.getElementById('emoneyNumberError').textContent = 'This field is required';
                    isValid = false;
                }
                
                const emoneyPin = document.getElementById('emoneyPin');
                if (!emoneyPin.value.trim()) {
                    document.getElementById('emoneyPinError').textContent = 'This field is required';
                    isValid = false;
                } else if (emoneyPin.value.length !== 4) {
                    document.getElementById('emoneyPinError').textContent = 'PIN must be 4 digits';
                    isValid = false;
                }
            }
            
            return isValid;
        }
    </script>
</body>
</html>